{% extends 'base.html' %}
{% block title %}Персонал · Healthcare CRM{% endblock %}
{% block breadcrumb %}Модули / Персонал{% endblock %}
{% block header %}Персонал{% endblock %}

{% block content %}
<div class="card p-5">
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
    <div>
      <h2 class="text-lg font-semibold">Список персонала</h2>
      <p class="text-sm text-slate-600">Поиск по имени/телефону.</p>
    </div>
    <a class="btn btn-primary" href="{% url 'staff_create' %}">
      <i class="fa-solid fa-user-plus"></i> Добавить
    </a>
  </div>

  <form class="mt-4" method="get">
    <div class="flex gap-2">
      <input
        class="input flex-1"
        type="text"
        name="q"
        value="{{ query }}"
        placeholder="Поиск по имени или отделу..."
      />
      <button class="btn" type="submit">
        <i class="fa-solid fa-magnifying-glass"></i> Найти
      </button>
    </div>
  </form>

  <div class="mt-4 overflow-hidden rounded-2xl border border-slate-200">
    <table class="table">
      <thead>
        <tr>
          <th>Сотрудник</th>
          <th>Роль</th>
          <th>Отдел</th>
          <th>Контакты</th>
          <th class="text-right">Действия</th>
        </tr>
      </thead>
      <tbody>
        {% for s in staff %}
          <tr>
            <td class="font-semibold">{{ s.ism }}</td>
            <td class="text-slate-700">{{ s.get_lavozim_display }}</td>
            <td class="text-slate-700">{{ s.get_bolim_display }}</td>
            <td class="text-slate-700">{{ s.telefon }}</td>
            <td class="text-right space-x-2">
              <a class="btn" href="{% url 'staff_edit' s.id %}"><i class="fa-regular fa-pen-to-square"></i></a>
              <form class="inline" method="post" action="{% url 'staff_delete' s.id %}" onsubmit="return confirm('Удалить сотрудника?');">
                {% csrf_token %}
                <button class="btn border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100" type="submit">
                  <i class="fa-regular fa-trash-can"></i>
                </button>
              </form>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="5" class="text-slate-600">Нет персонала.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
