{% extends 'base.html' %}
{% block title %}Скрининг{% endblock %}
{% block breadcrumb %}Модули / <a class="text-blue-600 hover:underline" href="{% url 'patient_detail' patient.id %}">Пациент</a> / Скрининг{% endblock %}
{% block header %}Скрининг пациента{% endblock %}

{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
  <section class="card p-5 lg:col-span-2">
    <h2 class="text-lg font-semibold">Форма скрининга</h2>
    <p class="text-sm text-slate-600 mt-1">Заполните поля и получите предикты.</p>

    <form method="post" class="mt-4 space-y-4">
      {% csrf_token %}
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        {% for field in form %}
          <div class="{% if field.field.widget.input_type == 'textarea' %}sm:col-span-2{% endif %}">
            <label class="text-xs font-semibold text-slate-600">{{ field.label }}</label>
            <div class="mt-2">{{ field }}</div>
            {% if field.errors %}<div class="text-xs text-rose-700 mt-1">{{ field.errors|striptags }}</div>{% endif %}
          </div>
        {% endfor %}
      </div>

      <div class="flex gap-2 pt-2">
        <button class="btn btn-primary" type="submit"><i class="fa-solid fa-wand-magic-sparkles"></i> Рассчитать</button>
        <a class="btn" href="{% url 'patient_detail' patient.id %}">Назад</a>
      </div>
    </form>
  </section>

  <aside class="card p-5">
    <h2 class="text-lg font-semibold">Результат</h2>
    <p class="text-sm text-slate-600 mt-1">Показывайте предсказания модели.</p>

    <div class="mt-4 space-y-2">
      <div class="rounded-2xl border border-slate-200 bg-slate-50 p-4">
        <div class="text-xs text-slate-500">Diabetes</div>
        <div class="text-xl font-bold mt-1">{{ predictions.diabetes|default:"—" }}</div>
      </div>
      <div class="rounded-2xl border border-slate-200 bg-slate-50 p-4">
        <div class="text-xs text-slate-500">Heart</div>
        <div class="text-xl font-bold mt-1">{{ predictions.heart|default:"—" }}</div>
      </div>
    </div>
  </aside>
</div>
{% endblock %}
